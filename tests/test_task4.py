from scripts.Task4 import isTelemarketer, noIncomingCalls, findTelemarketers


calls = [['1408371942', '98453 94494', '01-09-2016 06:01:12', '186'],
         ['1408371333', '(022)28952819', '01-09-2016 06:01:59', '2093'],
         ['97424 22395', '(022)47410783', '01-09-2016 06:03:51', '1975'],
         ['93427 40118', '(080)33118033', '01-09-2016 06:11:23', '1156'],
         ['(080)67362492', '(04344)316423', '01-09-2016 07:24:45', '2258'],
         ['90356 11723', '81525 12041', '01-09-2016 07:24:45', '2258']]


texts = [['97424 22395', '97416 29480', '14-09-2016 20:52:17'],
         ['93427 40118', '93422 47940', '14-09-2016 20:58:50'],
         ['81525 12041', '90356 11723', '14-09-2016 20:59:30'],
         ['90366 36573', '97425 12708', '14-09-2016 21:00:07'],
         ['97424 53609', '97385 70012', '14-09-2016 21:01:01'],
         ['93410 56456', '98453 86521', '14-09-2016 21:03:52']]


calls2 = [['1408371123', '98453 94494', '01-09-2016 06:01:12', '186'],
          ['1408371456', '(022)28952819', '01-09-2016 06:01:59', '2093'],
          ['97424 22395', '93427 40118', '01-09-2016 06:03:51', '1975'],
          ['93427 40118', '97424 22395', '01-09-2016 06:11:23', '1156'],
          ['(080)67362492', '90356 11723', '01-09-2016 07:24:45', '2258'],
          ['90356 11723', '(080)67362492', '01-09-2016 07:24:45', '2258']]


def test_isTelemarkter_returns_not_in_text_file():
    assert isTelemarketer(calls, texts) == [
        '1408371942', '1408371333', '(080)67362492']


def test_noIncomingCalls_returns_not_incoming_calls():
    assert noIncomingCalls(calls2) == ['1408371123', '1408371456']


def test_findTelemarketers_returns_telemarketers():
    assert findTelemarketers(calls2, texts) == ['1408371123', '1408371456']
